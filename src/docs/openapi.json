{
  "openapi": "3.0.3",
  "info": {
    "title": "Venpa Online API",
    "version": "1.0.0",
    "description": "API for online buy side and delivery sync."
  },
  "tags": [
    { "name": "System" },
    { "name": "Auth" },
    { "name": "Products" },
    { "name": "Reviews" },
    { "name": "Cart" },
    { "name": "Wishlist" },
    { "name": "Checkout" },
    { "name": "Profile" },
    { "name": "Email" },
    { "name": "Sync" },
    { "name": "Master" }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Health check",
        "description": "Check if the API is running and healthy",
        "tags": ["System"],
        "responses": {
          "200": {
            "description": "API is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "service": {
                      "type": "string",
                      "example": "venpa-online-api"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/departments": {
      "get": {
        "summary": "List departments",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/departments/{id}": {
      "get": {
        "summary": "Get department by id",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not found"
          }
        }
      }
    },
    "/api/v1/categories": {
      "get": {
        "summary": "List categories",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "department",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "cat_code",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/categories/{id}": {
      "get": {
        "summary": "Get category by id",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not found"
          }
        }
      }
    },
    "/api/v1/subcategories": {
      "get": {
        "summary": "List subcategories",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "department",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "cat_code",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/subcategories/{id}": {
      "get": {
        "summary": "Get subcategory by id",
        "tags": ["Master"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not found"
          }
        }
      }
    },
    "/api/v1/products": {
      "get": {
        "summary": "List products",
        "tags": ["Products"],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "department",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "category",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sub_category",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/products/new/arrivals": {
      "get": {
        "summary": "Get new arrivals",
        "tags": ["Products"],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/products/search": {
      "get": {
        "summary": "Search products",
        "tags": ["Products"],
        "parameters": [
          { "name": "q", "in": "query", "schema": { "type": "string" } },
          { "name": "query", "in": "query", "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    },
    "/api/v1/products/best/selling": {
      "get": {
        "summary": "Get best selling (danata random ewa enne)",
        "tags": ["Products"],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/products/code/{prod_code}": {
      "get": {
        "summary": "Get product by code",
        "tags": ["Products"],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not found"
          }
        }
      }
    },
    "/api/v1/sync/all": {
      "post": {
        "summary": "Sync all selected tables",
        "tags": ["Sync"],
        "parameters": [
          {
            "name": "full",
            "in": "query",
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/sync/{entity}": {
      "post": {
        "summary": "Sync one table",
        "tags": ["Sync"],
        "parameters": [
          {
            "name": "entity",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "summary": "Register a new user",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "fname",
                  "lname",
                  "email",
                  "phone",
                  "password",
                  "confirm_password"
                ],
                "properties": {
                  "fname": { "type": "string" },
                  "lname": { "type": "string" },
                  "email": { "type": "string", "format": "email" },
                  "phone": { "type": "string" },
                  "password": { "type": "string", "format": "password" },
                  "confirm_password": { "type": "string", "format": "password" }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Bad Request"
          }
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "Login user",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password"],
                "properties": {
                  "email": { "type": "string", "format": "email" },
                  "password": { "type": "string", "format": "password" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad Request"
          },
          "401": {
            "description": "Unauthorized"
          }
        }
      }
    },
    "/api/v1/auth/google-login": {
      "post": {
        "summary": "Google login",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["idToken"],
                "properties": {
                  "idToken": { "type": "string" },
                  "email": { "type": "string" },
                  "name": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" },
          "401": { "description": "Unauthorized" }
        }
      }
    },
    "/api/v1/auth/password/forgot": {
      "post": {
        "summary": "Send password reset code",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email"],
                "properties": {
                  "email": { "type": "string", "format": "email" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" },
          "404": { "description": "Not Found" }
        }
      }
    },
    "/api/v1/auth/password/reset": {
      "post": {
        "summary": "Reset password with code",
        "tags": ["Auth"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "code", "new_password"],
                "properties": {
                  "email": { "type": "string", "format": "email" },
                  "code": { "type": "string" },
                  "new_password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" },
          "404": { "description": "Not Found" }
        }
      }
    },
    "/api/v1/auth/me": {
      "get": {
        "summary": "Get current user profile",
        "tags": ["Auth"],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/profile/summary": {
      "get": {
        "summary": "Profile summary (user + orders/reviews/points)",
        "tags": ["Profile"],
        "responses": {
          "200": {
            "description": "OK"
          },
          "401": {
            "description": "Unauthorized"
          }
        }
      },
      "put": {
        "summary": "Update profile summary details",
        "tags": ["Profile"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fname": { "type": "string" },
                  "lname": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    },
    "/api/v1/cart": {
      "get": {
        "summary": "Get user's active cart",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "summary": "Add item to cart",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["prod_code", "quantity"],
                "properties": {
                  "prod_code": { "type": "string" },
                  "quantity": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "delete": {
        "summary": "Clear entire cart",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/cart/items": {
      "post": {
        "summary": "Bulk ekak widihata cart items adding",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "prod_code": { "type": "string" },
                        "quantity": { "type": "integer" }
                      },
                      "required": ["prod_code", "quantity"]
                    }
                  }
                },
                "required": ["items"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/cart/product/{prod_code}": {
      "put": {
        "summary": "Update cart item quantity by product code",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["quantity"],
                "properties": {
                  "quantity": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "delete": {
        "summary": "Remove item from cart by product code",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/wishlist": {
      "get": {
        "summary": "Get user's wishlist",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "summary": "Add item to wishlist",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["prod_code"],
                "properties": {
                  "prod_code": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        }
      },
      "delete": {
        "summary": "Clear wishlist",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/wishlist/products": {
      "get": {
        "summary": "Get wishlist products only",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/wishlist/product/{prod_code}/count": {
      "get": {
        "summary": "Count wishlists for a product",
        "tags": ["Wishlist"],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "OK" },
          "404": { "description": "Not Found" }
        }
      }
    },
    "/api/v1/wishlist/items": {
      "post": {
        "summary": "Add wishlist items in bulk",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "prod_code": { "type": "string" }
                      },
                      "required": ["prod_code"]
                    }
                  }
                },
                "required": ["items"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/wishlist/product/{prod_code}": {
      "delete": {
        "summary": "Remove item from wishlist by product code",
        "tags": ["Wishlist"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/cart/quantity": {
      "put": {
        "summary": "Update cart item quantity by product code",
        "tags": ["Cart"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "prod_code": { "type": "string" },
                  "quantity": { "type": "integer" }
                },
                "required": ["prod_code", "quantity"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/reviews/product/{prod_code}": {
      "get": {
        "summary": "List reviews for a product",
        "tags": ["Reviews"],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "OK" },
          "404": { "description": "Not found" }
        }
      }
    },
    "/api/v1/reviews/product/{prod_code}/average": {
      "get": {
        "summary": "Average rating point ekak gannawa product ekata",
        "tags": ["Reviews"],
        "parameters": [
          {
            "name": "prod_code",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "OK" },
          "404": { "description": "Not found" }
        }
      }
    },
    "/api/v1/reviews": {
      "post": {
        "summary": "Create or update a review",
        "tags": ["Reviews"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["prod_code", "rating"],
                "properties": {
                  "prod_code": { "type": "string" },
                  "rating": { "type": "integer" },
                  "comment": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "201": { "description": "Created" }
        }
      }
    },
    "/api/v1/checkout": {
      "get": {
        "summary": "List user's checkouts",
        "tags": ["Checkout"],
        "security": [
          { "bearerAuth": [] }
        ],
        "responses": {
          "200": { "description": "OK" }
        }
      },
      "post": {
        "summary": "Create checkout (order payload)",
        "tags": ["Checkout"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {}
              }
            }
          }
        },
        "responses": {
          "201": { "description": "Created" }
        }
      }
    },
    "/api/v1/email/send": {
      "post": {
        "summary": "Send email verification code",
        "tags": ["Email"],
        "security": [
          { "bearerAuth": [] }
        ],
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    },
    "/api/v1/email/verify": {
      "post": {
        "summary": "Verify email code",
        "tags": ["Email"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["code"],
                "properties": {
                  "code": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    },
    "/api/v1/email/change/send": {
      "post": {
        "summary": "Send email change code",
        "tags": ["Email"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["new_email"],
                "properties": {
                  "new_email": { "type": "string", "format": "email" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    },
    "/api/v1/email/change/verify": {
      "post": {
        "summary": "Verify email change code",
        "tags": ["Email"],
        "security": [
          { "bearerAuth": [] }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["code"],
                "properties": {
                  "code": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "OK" },
          "400": { "description": "Bad Request" }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Department": {
        "type": "object",
        "properties": {
          "dep_code": {
            "type": "string"
          },
          "dep_name": {
            "type": "string"
          },
          "dep_image": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer"
          }
        }
      },
      "Category": {
        "type": "object",
        "properties": {
          "cat_code": {
            "type": "string"
          },
          "cat_name": {
            "type": "string"
          },
          "department": {
            "type": "string"
          },
          "cat_image": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer"
          }
        }
      },
      "SubCategory": {
        "type": "object",
        "properties": {
          "scat_code": {
            "type": "string"
          },
          "scat_name": {
            "type": "string"
          },
          "department": {
            "type": "string"
          },
          "cat_code": {
            "type": "string"
          },
          "status": {
            "type": "integer"
          }
        },
      "Wishlist": {
        "type": "object",
        "properties": {
          "prod_code": { "type": "string" },
          "product": {
            "$ref": "#/components/schemas/Product"
          }
        }
      }
      },
      "Product": {
        "type": "object",
        "properties": {
          "prod_code": {
            "type": "string"
          },
          "prod_name": {
            "type": "string"
          },
          "short_description": {
            "type": "string",
            "nullable": true
          },
          "department": {
            "type": "string"
          },
          "category": {
            "type": "string",
            "nullable": true
          },
          "sub_category": {
            "type": "string",
            "nullable": true
          },
          "pack_size": {
            "type": "string",
            "nullable": true
          },
          "purchase_price": {
            "type": "number",
            "format": "float"
          },
          "selling_price": {
            "type": "number",
            "format": "float"
          },
          "marked_price": {
            "type": "number",
            "format": "float"
          },
          "wholesale_price": {
            "type": "number",
            "format": "float"
          },
          "title_in_other_language": {
            "type": "string",
            "nullable": true
          },
          "book_type": {
            "type": "string",
            "nullable": true
          },
          "publisher": {
            "type": "string",
            "nullable": true
          },
          "isbn": {
            "type": "string",
            "nullable": true
          },
          "publish_year": {
            "type": "integer",
            "nullable": true
          },
          "alert_qty": {
            "type": "integer",
            "nullable": true
          },
          "images": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "$ref": "#/components/schemas/ProductImage"
                }
              ]
            },
            "nullable": true
          }
        }
      },
      "ProductImage": {
        "type": "object",
        "properties": {
          "prod_code": {
            "type": "string"
          },
          "image": {
            "type": "string"
          }
        }
      },
      "Cart": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CartItem"
            }
          }
        }
      },
      "CartItem": {
        "type": "object",
        "properties": {
          "quantity": {
            "type": "integer"
          },
          "product": {
            "$ref": "#/components/schemas/Product"
          }
        }
      }
    }
  }
  ,
  "security": [
    { "bearerAuth": [] }
  ]
}
